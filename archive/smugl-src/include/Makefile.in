# $Id: Makefile.in,v 1.8 1997/11/26 17:26:37 oliver Exp $
# Common rules for makefiles
#

# default rule:
all::	$(EXES)

# Programs
CC              = @CC@
CXX             = @CXX@
RANLIB          = @RANLIB@
PERL            = @PERL@
INSTALL         = @INSTALL@
INSTALL_PROGRAM = $(INSTALL)
INSTALL_DATA    = $(INSTALL)

prefix          = @prefix@
exec_prefix     = @exec_prefix@
bindir          = @bindir@
srcdir          = @top_srcdir@

INCDIR          = ../include
LIBDIR          = ../lib

SMUGLLIB        = $(srcdir)/lib/libsmugl.a

# In developer mode - use the following CFLAGS
CFLAGS          = @CFLAGS@ @DEFS@
CPPFLAGS        = @CPPFLAGS@
ALL_CFLAGS      = -I. -I$(INCDIR) $(CFLAGS)
LIBS            = -L$(LIBDIR) -lsmugl @LIBS@ @LDFLAGS@

# Tidy up rules
clean::
	rm -f *.o *.bak *~ core *.core *TAGS*
	@TAGS@ *.cpp *.hpp

distclean: clean
	rm -f $(EXES) *.a *.status *.cache *.log Makefile Makefile.dep

# General rules
.cpp.o::
	$(CXX) -c $(CPPFLAGS) $(ALL_CFLAGS) $<

tags::
	@TAGS@ *.cpp

depend::
	$(CXX) $(CPPFLAGS) $(ALL_CFLAGS) -MM *.cpp >Makefile.dep

tidy: $(SRCS)
	clang-tidy-8 --config= *.cpp -- -DHAVE_CONFIG_H -I../include -I.

fix-tidy: $(SRCS)
	clang-tidy-8 --config= *.cpp -- -DHAVE_CONFIG_H -I../include -I.

# Stuff for dealing with version files
../include/$(VER).h: ../include/$(VER).rev
	@perl $(srcdir)/bin/mkrev -b $(srcdir)/include/$(VER)
	@touch $@
